# Laravel-Elmikeev-App

Тестоовое задание Elmekeev на позицию PHP-разработчик

Задача: Вам необходимо стянуть все данные по описанным эндпоинтам и сохранить в БД.
Доступы для БД выгружать в файл README.MD

- приложение должно быть развернуто с помощью docker-compose с 2 сервисами: php и mysql,
- используйте нестандартный порт MySQL (не 3306),
- нужно организовать ежедневное обновление данных дважды в день,
- предусмотреть в методах ошибки типа 'Too many requests' и их преодоление,
- сделать вывод отладочной информации в консоль,
- в бд организовать структуру для хранения данных: компании, у неё может быть несколько аккаунтов, у каждого аккаунта
  может быть один токен одного типа для одного апи сервиса,
- токены могут быть разного типа(bearer,api-key,login and password и тд), так-же должны быть апи сервисы, для которых
  предназначены токены, у каждого апи сервиса свой набор типов токенов,
- написать команды для добавления через консоль новых: компании, аккаунтов, апи токена, апи сервиса, типа токена,
- в методах получения данных предусмотреть использование разных аккаунтов,
- в таблицы данных добавить поле account_id, так же предотвратить затирание данных из разных аккаунтов,
- предусмотреть получение только свежих данных по полю date

---

Сервис для выгрузки данных из внешнего API и сохранения их в бд.

## Разворачивание через Docker

1. Построить и запустить контейнеры:

```bash
docker compose up -d --build
docker compose exec app bash
php artisan migrate
```

2. Добавить данные:

```bash
php artisan add:company "Company"
php artisan add:account 1 "Account"
php artisan add:service "ServiceName" "https://api.example.ru"
php artisan add:tokentype "api-key"
php artisan add:service-tokentype 1 1
php artisan add:token 1 1 "api-key" "API_KEY"

```

3. Запустить команду для выгрузки данных:

Для одного аккаунта:

```bash
php artisan fetch:all 1 "2025-01-01" "2025-10-02"
```

Для всех аккаунтов:

```bash
php artisan fetch:all --account-all "2025-01-01" "2025-10-02"
```

Даты можно не писать, скрипт автоматически возьмет свежие данные.
